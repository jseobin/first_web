{% extends 'admin/layout.html' %}
{% block content %}
<section class="panel">
    <h2>성적 관리</h2>
    <form method="post" class="form-grid">
        <input type="hidden" name="action" value="add_score">
        <label>학생
            <select name="student_id" required>
                <option value="">선택</option>
                {% for student in students %}
                    <option value="{{ student.id }}">{{ student.full_name }} ({{ student.username }})</option>
                {% endfor %}
            </select>
        </label>
        <label>시험명
            <input name="test_name" required>
        </label>
        <label>점수
            <input type="number" step="0.1" name="score" required>
        </label>
        <label>만점
            <input type="number" step="0.1" name="max_score" value="100" required>
        </label>
        <label>성적 분석
            <textarea name="analysis" rows="3"></textarea>
        </label>
        <button class="btn" type="submit">성적 공지</button>
    </form>
</section>

<section class="panel">
    <h3>성적 목록</h3>
    <table class="table">
        <thead>
            <tr>
                <th>학생</th>
                <th>시험명</th>
                <th>점수</th>
                <th>분석</th>
                <th>등록일</th>
                <th>삭제</th>
            </tr>
        </thead>
        <tbody>
            {% for item in scores %}
                <tr>
                    <td>{{ item.student_name }}</td>
                    <td>{{ item.test_name }}</td>
                    <td>{{ item.score }}/{{ item.max_score }}</td>
                    <td>{{ item.analysis or '-' }}</td>
                    <td>{{ item.created_at }}</td>
                    <td>
                        <form method="post">
                            <input type="hidden" name="action" value="delete_score">
                            <input type="hidden" name="score_id" value="{{ item.id }}">
                            <button class="btn ghost" data-confirm="성적을 삭제할까요?" type="submit">삭제</button>
                        </form>
                    </td>
                </tr>
            {% else %}
                <tr><td colspan="6">등록된 성적이 없습니다.</td></tr>
            {% endfor %}
        </tbody>
    </table>
</section>
{% endblock %}
